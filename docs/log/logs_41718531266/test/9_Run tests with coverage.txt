2025-07-15T03:02:45.3250346Z ##[group]Run coverage run -m pytest tests/ -v
2025-07-15T03:02:45.3250699Z [36;1mcoverage run -m pytest tests/ -v[0m
2025-07-15T03:02:45.3250980Z [36;1mcoverage report --show-missing[0m
2025-07-15T03:02:45.3251232Z [36;1mcoverage xml[0m
2025-07-15T03:02:45.3275997Z shell: /usr/bin/bash -e {0}
2025-07-15T03:02:45.3276256Z env:
2025-07-15T03:02:45.3276500Z   pythonLocation: /opt/hostedtoolcache/Python/3.12.11/x64
2025-07-15T03:02:45.3276914Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.12.11/x64/lib/pkgconfig
2025-07-15T03:02:45.3277332Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.12.11/x64
2025-07-15T03:02:45.3277688Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.12.11/x64
2025-07-15T03:02:45.3278039Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.12.11/x64
2025-07-15T03:02:45.3278389Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.12.11/x64/lib
2025-07-15T03:02:45.3278683Z   BOOK_USER: testuser
2025-07-15T03:02:45.3278887Z   BOOK_PASS: testpass
2025-07-15T03:02:45.3279087Z   OPENAI_API_KEY: test-key
2025-07-15T03:02:45.3279322Z ##[endgroup]
2025-07-15T03:02:47.0923837Z ============================= test session starts ==============================
2025-07-15T03:02:47.0925019Z platform linux -- Python 3.12.11, pytest-8.4.1, pluggy-1.6.0 -- /opt/hostedtoolcache/Python/3.12.11/x64/bin/python
2025-07-15T03:02:47.0925980Z cachedir: .pytest_cache
2025-07-15T03:02:47.0926585Z rootdir: /home/runner/work/book_triage_v0.1.0/book_triage_v0.1.0
2025-07-15T03:02:47.0927191Z configfile: pyproject.toml
2025-07-15T03:02:47.0927528Z plugins: cov-6.2.1, anyio-4.9.0
2025-07-15T03:02:51.0748811Z collecting ... collected 111 items
2025-07-15T03:02:51.0749219Z 
2025-07-15T03:02:51.2121997Z tests/test_api.py::TestAPIEndpoints::test_root_endpoint PASSED           [  0%]
2025-07-15T03:02:51.2413370Z tests/test_api.py::TestAPIEndpoints::test_health_endpoint PASSED         [  1%]
2025-07-15T03:02:51.2690167Z tests/test_api.py::TestAPIEndpoints::test_get_books_empty PASSED         [  2%]
2025-07-15T03:02:51.3024291Z tests/test_api.py::TestAPIEndpoints::test_get_books_with_data PASSED     [  3%]
2025-07-15T03:02:51.3558265Z tests/test_api.py::TestAPIEndpoints::test_upload_photo_success PASSED    [  4%]
2025-07-15T03:02:51.3847740Z tests/test_api.py::TestAPIEndpoints::test_scan_books_unauthorized PASSED [  5%]
2025-07-15T03:02:51.4118818Z tests/test_api.py::TestAPIEndpoints::test_rate_limiting_books_endpoint PASSED [  6%]
2025-07-15T03:02:51.4663074Z tests/test_api.py::TestAPIEndpoints::test_file_upload_size_limit PASSED  [  7%]
2025-07-15T03:02:51.4945359Z tests/test_api.py::TestAPIEndpoints::test_security_headers_in_response PASSED [  8%]
2025-07-15T03:02:51.5258479Z tests/test_api.py::TestAPIEndpoints::test_upload_photo_no_title_extracted PASSED [  9%]
2025-07-15T03:02:51.5572541Z tests/test_api.py::TestAPIEndpoints::test_upload_photo_vision_processor_exception PASSED [  9%]
2025-07-15T03:02:51.5850478Z tests/test_api.py::TestAPIEndpoints::test_upload_photo_no_file PASSED    [ 10%]
2025-07-15T03:02:51.6138012Z tests/test_api.py::TestAPIEndpoints::test_scan_books_success PASSED      [ 11%]
2025-07-15T03:02:51.6427900Z tests/test_api.py::TestAPIEndpoints::test_scan_books_exception PASSED    [ 12%]
2025-07-15T03:02:51.6708338Z tests/test_api.py::TestAPIEndpoints::test_rescan_title_record_not_found PASSED [ 13%]
2025-07-15T03:02:51.7010513Z tests/test_api.py::TestAPIEndpoints::test_add_manual_title_success PASSED [ 14%]
2025-07-15T03:02:51.7282736Z tests/test_api.py::TestAPIEndpoints::test_add_manual_title_missing_isbn PASSED [ 15%]
2025-07-15T03:02:51.7554863Z tests/test_api.py::TestAPIEndpoints::test_add_manual_title_invalid_isbn PASSED [ 16%]
2025-07-15T03:02:51.7794064Z tests/test_api.py::TestAPIInitialization::test_initialize_app PASSED     [ 17%]
2025-07-15T03:02:51.7865809Z tests/test_api.py::TestAPIInitialization::test_app_without_initialization PASSED [ 18%]
2025-07-15T03:02:51.8102293Z tests/test_cli.py::TestCLICommands::test_cli_help PASSED                 [ 18%]
2025-07-15T03:02:51.8163850Z tests/test_cli.py::TestCLICommands::test_scan_command_success PASSED     [ 19%]
2025-07-15T03:02:51.8227839Z tests/test_cli.py::TestCLICommands::test_scan_command_with_options PASSED [ 20%]
2025-07-15T03:02:51.8283807Z tests/test_cli.py::TestCLICommands::test_scan_command_no_records PASSED  [ 21%]
2025-07-15T03:02:51.8341917Z tests/test_cli.py::TestCLICommands::test_scan_command_nonexistent_file PASSED [ 22%]
2025-07-15T03:02:51.8395857Z tests/test_cli.py::TestCLICommands::test_scan_command_exception PASSED   [ 23%]
2025-07-15T03:02:51.8460467Z tests/test_cli.py::TestCLICommands::test_web_command_success PASSED      [ 24%]
2025-07-15T03:02:51.8524305Z tests/test_cli.py::TestCLICommands::test_web_command_with_options PASSED [ 25%]
2025-07-15T03:02:51.8585835Z tests/test_cli.py::TestCLICommands::test_web_command_nonexistent_file PASSED [ 26%]
2025-07-15T03:02:51.8643079Z tests/test_cli.py::TestCLICommands::test_web_command_exception PASSED    [ 27%]
2025-07-15T03:02:51.8728281Z tests/test_cli.py::TestCLICommands::test_create_csv_command_empty PASSED [ 27%]
2025-07-15T03:02:51.8819360Z tests/test_cli.py::TestCLICommands::test_create_csv_command_with_sample PASSED [ 28%]
2025-07-15T03:02:51.8879119Z tests/test_cli.py::TestCLICommands::test_create_csv_command_creates_directory PASSED [ 29%]
2025-07-15T03:02:51.8937660Z tests/test_cli.py::TestCLICommands::test_create_csv_command_exception PASSED [ 30%]
2025-07-15T03:02:51.9020409Z tests/test_cli.py::TestCLICommands::test_info_command_success PASSED     [ 31%]
2025-07-15T03:02:51.9068313Z tests/test_cli.py::TestCLICommands::test_info_command_nonexistent_file PASSED [ 32%]
2025-07-15T03:02:51.9122205Z tests/test_cli.py::TestCLICommands::test_info_command_exception PASSED   [ 33%]
2025-07-15T03:02:51.9201192Z tests/test_cli.py::TestCLIValidation::test_scan_cost_validation_min PASSED [ 34%]
2025-07-15T03:02:51.9272009Z tests/test_cli.py::TestCLIValidation::test_scan_cost_validation_max PASSED [ 35%]
2025-07-15T03:02:51.9337265Z tests/test_cli.py::TestCLIValidation::test_port_validation PASSED        [ 36%]
2025-07-15T03:02:51.9404663Z tests/test_cli.py::TestCLIIntegration::test_scan_integration_with_core PASSED [ 36%]
2025-07-15T03:02:51.9467388Z tests/test_cli.py::TestCLIIntegration::test_web_integration_with_api PASSED [ 37%]
2025-07-15T03:02:51.9604145Z tests/test_cli.py::TestCLIEnvironment::test_environment_loading PASSED   [ 38%]
2025-07-15T03:02:51.9739717Z tests/test_cli.py::TestCLIEnvironment::test_logging_configuration PASSED [ 39%]
2025-07-15T03:02:51.9805563Z tests/test_cli.py::TestCLIEnvironment::test_verbose_logging PASSED       [ 40%]
2025-07-15T03:02:51.9817550Z tests/test_core.py::TestBookRecord::test_book_record_creation PASSED     [ 41%]
2025-07-15T03:02:51.9829238Z tests/test_core.py::TestBookRecord::test_book_record_to_dict PASSED      [ 42%]
2025-07-15T03:02:51.9841022Z tests/test_core.py::TestBookRecord::test_book_record_with_all_fields PASSED [ 43%]
2025-07-15T03:02:51.9856018Z tests/test_core.py::TestBookTriage::test_book_triage_initialization_nonexistent_file PASSED [ 44%]
2025-07-15T03:02:51.9902556Z tests/test_core.py::TestBookTriage::test_book_triage_initialization_with_data PASSED [ 45%]
2025-07-15T03:02:51.9916648Z tests/test_core.py::TestBookTriage::test_calculate_utilities PASSED      [ 45%]
2025-07-15T03:02:51.9930097Z tests/test_core.py::TestBookTriage::test_calculate_utilities_with_none_values PASSED [ 46%]
2025-07-15T03:02:51.9944108Z tests/test_core.py::TestBookTriage::test_make_decision PASSED            [ 47%]
2025-07-15T03:02:51.9995433Z tests/test_core.py::TestBookTriage::test_add_record PASSED               [ 48%]
2025-07-15T03:02:52.0041276Z tests/test_core.py::TestBookTriage::test_get_record_by_id PASSED         [ 49%]
2025-07-15T03:02:52.0089572Z tests/test_core.py::TestBookTriage::test_price_to_v_calculation PASSED   [ 50%]
2025-07-15T03:02:52.0111413Z tests/test_core.py::TestBookTriage::test_enrich_with_gpt4o_mock PASSED   [ 51%]
2025-07-15T03:02:52.0126070Z tests/test_core.py::TestBookTriage::test_scan_cost_parameter PASSED      [ 52%]
2025-07-15T03:02:52.0136963Z tests/test_core.py::TestDecisionEnum::test_decision_values PASSED        [ 53%]
2025-07-15T03:02:52.0150274Z tests/test_core.py::TestDecisionEnum::test_decision_comparison PASSED    [ 54%]
2025-07-15T03:02:52.0161893Z tests/test_core_simple.py::TestBookRecord::test_book_record_creation PASSED [ 54%]
2025-07-15T03:02:52.0173021Z tests/test_core_simple.py::TestBookRecord::test_book_record_with_values PASSED [ 55%]
2025-07-15T03:02:52.0186331Z tests/test_core_simple.py::TestBookTriage::test_book_triage_initialization PASSED [ 56%]
2025-07-15T03:02:52.0199511Z tests/test_core_simple.py::TestBookTriage::test_calculate_utilities_simple PASSED [ 57%]
2025-07-15T03:02:52.0212688Z tests/test_core_simple.py::TestBookTriage::test_make_decision_simple PASSED [ 58%]
2025-07-15T03:02:52.0225926Z tests/test_core_simple.py::TestDecision::test_decision_values PASSED     [ 59%]
2025-07-15T03:02:52.0812986Z tests/test_indicators_implementation.py::test_v_calculation_from_prices PASSED [ 60%]
2025-07-15T03:02:52.0827692Z tests/test_indicators_implementation.py::test_utility_calculations PASSED [ 61%]
2025-07-15T03:02:52.0843803Z tests/test_indicators_implementation.py::test_decision_making PASSED     [ 62%]
2025-07-15T03:02:52.0856794Z tests/test_indicators_implementation.py::test_human_vs_auto_indicators PASSED [ 63%]
2025-07-15T03:02:52.0878532Z tests/test_indicators_implementation.py::test_scan_cost_impact PASSED    [ 63%]
2025-07-15T03:02:52.0902562Z tests/test_main.py::TestMainModule::test_main_no_args_with_existing_csv PASSED [ 64%]
2025-07-15T03:02:52.0924326Z tests/test_main.py::TestMainModule::test_main_no_args_creates_new_csv PASSED [ 65%]
2025-07-15T03:02:52.0944377Z tests/test_main.py::TestMainModule::test_main_with_args PASSED           [ 66%]
2025-07-15T03:02:52.0965136Z tests/test_main.py::TestMainModule::test_main_finds_alternative_csv_paths PASSED [ 67%]
2025-07-15T03:02:52.0983869Z tests/test_main.py::TestMainModule::test_main_module_entry_point PASSED  [ 68%]
2025-07-15T03:02:53.6163859Z tests/test_verified_display_logic.py::test_verified_column_uses_strict_equality PASSED [ 69%]
2025-07-15T03:02:53.6185784Z tests/test_vision.py::TestVisionProcessor::test_vision_processor_initialization_with_openai PASSED [ 70%]
2025-07-15T03:02:53.6197475Z tests/test_vision.py::TestVisionProcessor::test_vision_processor_initialization_without_openai PASSED [ 71%]
2025-07-15T03:02:53.6209762Z tests/test_vision.py::TestVisionProcessor::test_generate_id PASSED       [ 72%]
2025-07-15T03:02:53.6263621Z tests/test_vision.py::TestVisionProcessor::test_extract_title_from_image_openai_success PASSED [ 72%]
2025-07-15T03:02:53.6294024Z tests/test_vision.py::TestVisionProcessor::test_extract_title_from_image_fallback_to_tesseract PASSED [ 73%]
2025-07-15T03:02:53.6308470Z tests/test_vision.py::TestVisionProcessor::test_extract_title_from_image_nonexistent_file PASSED [ 74%]
2025-07-15T03:02:53.6329358Z tests/test_vision.py::TestVisionProcessor::test_extract_with_tesseract_success PASSED [ 75%]
2025-07-15T03:02:53.6349945Z tests/test_vision.py::TestVisionProcessor::test_extract_with_tesseract_empty_result PASSED [ 76%]
2025-07-15T03:02:53.6370994Z tests/test_vision.py::TestVisionProcessor::test_extract_with_tesseract_error PASSED [ 77%]
2025-07-15T03:02:53.6413800Z tests/test_vision.py::TestVisionProcessor::test_extract_with_openai_vision_no_content PASSED [ 78%]
2025-07-15T03:02:53.6443867Z tests/test_vision.py::TestVisionProcessor::test_extract_with_openai_vision_no_client PASSED [ 79%]
2025-07-15T03:02:53.6489856Z tests/test_vision.py::TestVisionProcessor::test_extract_title_and_isbn_from_image_success PASSED [ 80%]
2025-07-15T03:02:53.6509648Z tests/test_vision.py::TestVisionProcessor::test_extract_title_and_isbn_tesseract_fallback PASSED [ 81%]
2025-07-15T03:02:53.6522313Z tests/test_vision.py::TestVisionProcessor::test_extract_title_and_isbn_nonexistent_file PASSED [ 81%]
2025-07-15T03:02:53.6551880Z tests/test_vision.py::TestVisionProcessor::test_extract_title_and_isbn_no_isbn_found PASSED [ 82%]
2025-07-15T03:02:53.6582270Z tests/test_vision.py::TestVisionProcessor::test_image_format_conversion PASSED [ 83%]
2025-07-15T03:02:53.6605211Z tests/test_vision.py::TestVisionProcessorIntegration::test_processor_with_real_image_mock_ocr PASSED [ 84%]
2025-07-15T03:02:53.6620079Z tests/test_vision_fixed.py::TestVisionProcessor::test_vision_processor_initialization_with_openai PASSED [ 85%]
2025-07-15T03:02:53.6630849Z tests/test_vision_fixed.py::TestVisionProcessor::test_vision_processor_initialization_without_openai PASSED [ 86%]
2025-07-15T03:02:53.6641989Z tests/test_vision_fixed.py::TestVisionProcessor::test_generate_id PASSED [ 87%]
2025-07-15T03:02:53.6654063Z tests/test_vision_fixed.py::TestVisionProcessor::test_extract_title_from_image_nonexistent_file PASSED [ 88%]
2025-07-15T03:02:53.6696049Z tests/test_vision_fixed.py::TestVisionProcessor::test_extract_title_with_openai_vision_success PASSED [ 89%]
2025-07-15T03:02:53.6722096Z tests/test_vision_fixed.py::TestVisionProcessor::test_extract_title_fallback_to_tesseract PASSED [ 90%]
2025-07-15T03:02:53.6742307Z tests/test_vision_fixed.py::TestVisionProcessor::test_extract_with_tesseract_success PASSED [ 90%]
2025-07-15T03:02:53.6762824Z tests/test_vision_fixed.py::TestVisionProcessor::test_extract_with_tesseract_empty_result PASSED [ 91%]
2025-07-15T03:02:53.6786462Z tests/test_vision_fixed.py::TestVisionProcessor::test_extract_with_tesseract_error PASSED [ 92%]
2025-07-15T03:02:53.6825464Z tests/test_vision_fixed.py::TestVisionProcessor::test_extract_with_openai_vision_no_content PASSED [ 93%]
2025-07-15T03:02:53.6842268Z tests/test_vision_fixed.py::TestVisionProcessor::test_extract_with_openai_vision_no_client PASSED [ 94%]
2025-07-15T03:02:53.6882444Z tests/test_vision_fixed.py::TestVisionProcessor::test_extract_title_and_isbn_from_image_success PASSED [ 95%]
2025-07-15T03:02:53.6903137Z tests/test_vision_fixed.py::TestVisionProcessor::test_extract_title_and_isbn_tesseract_fallback PASSED [ 96%]
2025-07-15T03:02:53.6915302Z tests/test_vision_fixed.py::TestVisionProcessor::test_extract_title_and_isbn_nonexistent_file PASSED [ 97%]
2025-07-15T03:02:53.6935220Z tests/test_vision_fixed.py::TestVisionProcessor::test_extract_title_and_isbn_no_isbn_found PASSED [ 98%]
2025-07-15T03:02:53.6946389Z tests/test_vision_fixed.py::TestVisionProcessor::test_image_format_conversion PASSED [ 99%]
2025-07-15T03:02:53.9085421Z tests/test_vision_fixed.py::TestVisionProcessorIntegration::test_processor_with_real_image_mock_ocr PASSED [100%]
2025-07-15T03:02:53.9086193Z 
2025-07-15T03:02:53.9086395Z =============================== warnings summary ===============================
2025-07-15T03:02:53.9087406Z tests/test_indicators_implementation.py::test_v_calculation_from_prices
2025-07-15T03:02:53.9089156Z   /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/_pytest/python.py:161: PytestReturnNotNoneWarning: Test functions should return None, but tests/test_indicators_implementation.py::test_v_calculation_from_prices returned <class 'bool'>.
2025-07-15T03:02:53.9090903Z   Did you mean to use `assert` instead of `return`?
2025-07-15T03:02:53.9091904Z   See https://docs.pytest.org/en/stable/how-to/assert.html#return-not-none for more information.
2025-07-15T03:02:53.9092629Z     warnings.warn(
2025-07-15T03:02:53.9092763Z 
2025-07-15T03:02:53.9092955Z tests/test_indicators_implementation.py::test_utility_calculations
2025-07-15T03:02:53.9094073Z   /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/_pytest/python.py:161: PytestReturnNotNoneWarning: Test functions should return None, but tests/test_indicators_implementation.py::test_utility_calculations returned <class 'bool'>.
2025-07-15T03:02:53.9095110Z   Did you mean to use `assert` instead of `return`?
2025-07-15T03:02:53.9095586Z   See https://docs.pytest.org/en/stable/how-to/assert.html#return-not-none for more information.
2025-07-15T03:02:53.9096020Z     warnings.warn(
2025-07-15T03:02:53.9096139Z 
2025-07-15T03:02:53.9096309Z tests/test_indicators_implementation.py::test_decision_making
2025-07-15T03:02:53.9097371Z   /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/_pytest/python.py:161: PytestReturnNotNoneWarning: Test functions should return None, but tests/test_indicators_implementation.py::test_decision_making returned <class 'bool'>.
2025-07-15T03:02:53.9098569Z   Did you mean to use `assert` instead of `return`?
2025-07-15T03:02:53.9099036Z   See https://docs.pytest.org/en/stable/how-to/assert.html#return-not-none for more information.
2025-07-15T03:02:53.9099495Z     warnings.warn(
2025-07-15T03:02:53.9099614Z 
2025-07-15T03:02:53.9099826Z tests/test_indicators_implementation.py::test_human_vs_auto_indicators
2025-07-15T03:02:53.9100971Z   /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/_pytest/python.py:161: PytestReturnNotNoneWarning: Test functions should return None, but tests/test_indicators_implementation.py::test_human_vs_auto_indicators returned <class 'bool'>.
2025-07-15T03:02:53.9102267Z   Did you mean to use `assert` instead of `return`?
2025-07-15T03:02:53.9102760Z   See https://docs.pytest.org/en/stable/how-to/assert.html#return-not-none for more information.
2025-07-15T03:02:53.9103211Z     warnings.warn(
2025-07-15T03:02:53.9103332Z 
2025-07-15T03:02:53.9103510Z tests/test_indicators_implementation.py::test_scan_cost_impact
2025-07-15T03:02:53.9104593Z   /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/_pytest/python.py:161: PytestReturnNotNoneWarning: Test functions should return None, but tests/test_indicators_implementation.py::test_scan_cost_impact returned <class 'bool'>.
2025-07-15T03:02:53.9105549Z   Did you mean to use `assert` instead of `return`?
2025-07-15T03:02:53.9105996Z   See https://docs.pytest.org/en/stable/how-to/assert.html#return-not-none for more information.
2025-07-15T03:02:53.9106410Z     warnings.warn(
2025-07-15T03:02:53.9106525Z 
2025-07-15T03:02:53.9106708Z -- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
2025-07-15T03:02:53.9107137Z ======================= 111 passed, 5 warnings in 6.61s ========================
2025-07-15T03:02:54.2519749Z Name                      Stmts   Miss  Cover   Missing
2025-07-15T03:02:54.2520358Z -------------------------------------------------------
2025-07-15T03:02:54.2520835Z book_triage/__init__.py       3      0   100%
2025-07-15T03:02:54.2521284Z book_triage/__main__.py      21      0   100%
2025-07-15T03:02:54.2522016Z book_triage/api.py          162     38    77%   41, 66, 408, 477, 506, 510-547, 558, 560
2025-07-15T03:02:54.2522656Z book_triage/cli.py          117      8    93%   229, 231, 233, 235, 237, 239, 241, 250
2025-07-15T03:02:54.2523922Z book_triage/core.py         195     41    79%   108, 111-112, 121, 166-168, 173-174, 220, 233-234, 238-242, 248, 274-277, 285, 287-294, 297-298, 302, 311-326
2025-07-15T03:02:54.2524748Z book_triage/security.py      45     14    69%   27, 37-48, 64-69, 83, 89-90
2025-07-15T03:02:54.2525389Z book_triage/vision.py       100     10    90%   36-38, 164-165, 171, 173-174, 176-177
2025-07-15T03:02:54.2525923Z -------------------------------------------------------
2025-07-15T03:02:54.2526351Z TOTAL                       643    111    83%
2025-07-15T03:02:54.4105600Z Wrote XML report to coverage.xml
